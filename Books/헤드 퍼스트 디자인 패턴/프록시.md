# ν”„λ΅μ‹ ν¨ν„΄κ³Ό RMI (Remote Method Invocation)

## π― ν”„λ΅μ‹ ν¨ν„΄μ ν•µμ‹¬ κ°λ…

### ν”„λ΅μ‹ ν¨ν„΄μ΄λ€?

- **λ€λ¦¬μ ν¨ν„΄**: μ‹¤μ  κ°μ²΄μ— λ€ν• μ ‘κ·Όμ„ μ μ–΄ν•κΈ° μ„ν•΄ λ€λ¦¬μλ¥Ό μ κ³µ
- **ν¬λ…μ„±**: ν΄λΌμ΄μ–ΈνΈλ” ν”„λ΅μ‹λ¥Ό μ‚¬μ©ν•λ”μ§€ μ‹¤μ  κ°μ²΄λ¥Ό μ‚¬μ©ν•λ”μ§€ λ¨λ¦„

```java
// ν΄λΌμ΄μ–ΈνΈλ” λ™μΌν• μΈν„°νμ΄μ¤λ΅ μ‚¬μ©
Icon albumCover = new ImageProxy("http://example.com/album.jpg");
albumCover.paintIcon(); // μ²μμ—” "Loading..." ν‘μ‹
// μ‹κ°„μ΄ μ§€λ‚ ν›„...
albumCover.paintIcon(); // μ‹¤μ  μ΄λ―Έμ§€ ν‘μ‹ (ν΄λΌμ΄μ–ΈνΈλ” λ³€ν™”λ¥Ό λ¨λ¦„)
```

### ν”„λ΅μ‹ ν¨ν„΄μ μΆ…λ¥

1. **κ°€μƒ ν”„λ΅μ‹**: μƒμ„± λΉ„μ©μ΄ λ†’μ€ κ°μ²΄μ μƒμ„±μ„ μ§€μ—°
2. **λ³΄νΈ ν”„λ΅μ‹**: μ ‘κ·Ό κ¶ν•μ— λ”°λ¥Έ μ ‘κ·Ό μ μ–΄
3. **μ›κ²© ν”„λ΅μ‹**: λ‹¤λ¥Έ μ£Όμ† κ³µκ°„μ κ°μ²΄λ¥Ό λ΅μ»¬μ²λΌ μ‚¬μ© (RMI!)
4. **μ¤λ§νΈ μ°Έμ΅° ν”„λ΅μ‹**: μ¶”κ°€μ μΈ μ‘μ—… μν–‰ (λ΅κΉ…, μ°Έμ΅° νμ λ“±)

---

## π RMI: μ„λ΅ λ‹¤λ¥Έ JVM κ°„ ν†µμ‹ 

### RMIκ°€ ν•„μ”ν• μ΄μ 

- **λ©”λ¨λ¦¬ κ²©λ¦¬**: μ„λ΅ λ‹¤λ¥Έ JVMμ€ λ©”λ¨λ¦¬λ¥Ό κ³µμ ν•μ§€ μ•μ
- **λ„¤νΈμ›ν¬ ν†µμ‹  ν•„μ”**: κ°μ²΄μ λ©”λ¨λ¦¬ μ£Όμ†λ” μ „μ†΅ λ¶κ°€λ¥

```java
// β λ¶κ°€λ¥: μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈ λ©”λ¨λ¦¬μ— μ ‘κ·Ό
ν΄λΌμ΄μ–ΈνΈ JVM (0x1000 μ£Όμ†) β†’ μ„λ²„ JVM (μ ‘κ·Ό λ¶κ°€!)

// β… ν•΄κ²°: κ°μ²΄ λ‚΄μ©μ„ λ°”μ΄νΈλ΅ λ³€ν™ν•΄μ„ μ „μ†΅
κ°μ²΄ β†’ μ§λ ¬ν™” β†’ λ°”μ΄νΈ μ¤νΈλ¦Ό β†’ λ„¤νΈμ›ν¬ β†’ λ°”μ΄νΈ μ¤νΈλ¦Ό β†’ μ—­μ§λ ¬ν™” β†’ μƒ κ°μ²΄
```

---

## π”§ RMI κµ¬ν„ κ³Όμ •

### 1. μ›κ²© μΈν„°νμ΄μ¤ μ •μ

```java
public interface CalculatorService extends Remote {
    int add(int a, int b) throws RemoteException;
    int multiply(int a, int b) throws RemoteException;
}
```

### 2. μ„λΉ„μ¤ κµ¬ν„

```java
public class CalculatorServiceImpl extends UnicastRemoteObject implements CalculatorService {
    public CalculatorServiceImpl() throws RemoteException {
        super(); // μ›κ²© κ°μ²΄ μ΄κΈ°ν™”
    }

    public int add(int a, int b) throws RemoteException {
        return a + b; // μ‹¤μ  λΉ„μ¦λ‹μ¤ λ΅μ§
    }
}
```

### 3. μ„λ²„: λ μ§€μ¤νΈλ¦¬ λ“±λ΅

```java
public static void main(String[] args) {
    // 1. λ μ§€μ¤νΈλ¦¬ μ‹μ‘ (ν•„μ!)
    LocateRegistry.createRegistry(1099);

    // 2. μ‹¤μ  κ°μ²΄ μΈμ¤ν„΄μ¤ μƒμ„±
    CalculatorServiceImpl calculator = new CalculatorServiceImpl();

    // 3. λ μ§€μ¤νΈλ¦¬μ— λ“±λ΅
    Naming.rebind("CalculatorService", calculator);

    System.out.println("μ„λ²„ μ¤€λΉ„ μ™„λ£. ν΄λΌμ΄μ–ΈνΈ μ”μ²­ λ€κΈ° μ¤‘...");
}
```

### 4. ν΄λΌμ΄μ–ΈνΈ: ν”„λ΅μ‹ μ‚¬μ©

```java
public static void main(String[] args) {
    // lookup()μ€ Remote νƒ€μ… λ°ν™ β†’ λ‹¤μ΄μΊμ¤ν… ν•„μ”
    CalculatorService calc = (CalculatorService) Naming.lookup("rmi://localhost:1099/CalculatorService");

    // ν”„λ΅μ‹(μ¤ν…)λ¥Ό ν†µν• μ›κ²© νΈμ¶
    int result = calc.add(10, 20); // λ‚΄λ¶€μ μΌλ΅ λ„¤νΈμ›ν¬ ν†µμ‹ 
    System.out.println("κ²°κ³Ό: " + result);
}
```

---

## π“΅ RMI λ‚΄λ¶€ λ™μ‘ μ›λ¦¬

### μ¤ν…(Stub) = ν”„λ΅μ‹

```java
// RMIκ°€ μλ™ μƒμ„±ν•λ” μ¤ν… (μμ‚¬μ½”λ“)
public class CalculatorService_Stub implements CalculatorService {
    public int add(int a, int b) throws RemoteException {
        // 1. λ©”μ„λ“ νΈμ¶μ„ λ„¤νΈμ›ν¬ μ”μ²­μΌλ΅ λ³€ν™
        // 2. λ§¤κ°λ³€μ μ§λ ¬ν™”
        // 3. μ„λ²„λ΅ μ „μ†΅
        // 4. κ²°κ³Ό μμ‹  λ° μ—­μ§λ ¬ν™”
        // 5. ν΄λΌμ΄μ–ΈνΈμ— λ°ν™
    }
}
```

### μ „μ²΄ ν†µμ‹  κ³Όμ •

```
ν΄λΌμ΄μ–ΈνΈ: calc.add(10, 20)
     β†“
μ¤ν…: μ§λ ¬ν™” β†’ λ„¤νΈμ›ν¬ μ „μ†΅
     β†“
μ„λ²„: μ—­μ§λ ¬ν™” β†’ μ‹¤μ  κ°μ²΄.add(10, 20) μ‹¤ν–‰
     β†“
μ„λ²„: κ²°κ³Ό μ§λ ¬ν™” β†’ λ„¤νΈμ›ν¬ μ „μ†΅
     β†“
μ¤ν…: μ—­μ§λ ¬ν™” β†’ ν΄λΌμ΄μ–ΈνΈμ— λ°ν™
     β†“
ν΄λΌμ΄μ–ΈνΈ: result = 30 λ°›μ
```

---

## π”’ μ§λ ¬ν™” ν•„μ μ΅°κ±΄

### RMIμ—μ„ μ‚¬μ© κ°€λ¥ν• νƒ€μ…

```java
public interface MyService extends Remote {
    // β… μ›μ‹ νƒ€μ…
    int calculate(int a, int b) throws RemoteException;

    // β… String (μ΄λ―Έ Serializable)
    String processText(String input) throws RemoteException;

    // β… μ»¬λ ‰μ… (λ‚΄μ©λ¬Όλ„ Serializableμ΄μ–΄μ•Ό ν•¨)
    List<String> getNames() throws RemoteException;

    // β… Serializable κµ¬ν„ κ°μ²΄
    Person getPerson(String id) throws RemoteException;
}

// μ»¤μ¤ν…€ ν΄λμ¤λ” λ°λ“μ‹ Serializable κµ¬ν„
public class Person implements Serializable {
    private static final long serialVersionUID = 1L;
    private String name;
    private int age;
}
```

### μ§λ ¬ν™” λ¶κ°€λ¥ν• νƒ€μ…λ“¤

```java
// β μ΄λ° νƒ€μ…λ“¤ μ‚¬μ©ν•λ©΄ NotSerializableException λ°μƒ
Thread workerThread;        // Thread μ§λ ¬ν™” λ¶κ°€
Socket connection;          // Socket μ§λ ¬ν™” λ¶κ°€
FileInputStream fileStream; // FileInputStream μ§λ ¬ν™” λ¶κ°€
```

---

## π® μ‹¤μ  μ‚¬μ© μ‚¬λ΅€: GumballMonitor

### μ™ μ›κ²© μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λ”κ°€?

```java
// μ„μΉ ν¬λ…μ„±: λ΅μ»¬/μ›κ²© κµ¬λ¶„ μ—†μ΄ λ™μΌν• μ½”λ“
public class GumballMonitor {
    GumballMachineRemote machine; // μΈν„°νμ΄μ¤ μ‚¬μ©!

    public void report() {
        try {
            // λ΅μ»¬ νΈμ¶μΌ μλ„, λ„¤νΈμ›ν¬ νΈμ¶μΌ μλ„ μμ
            System.out.println("Location: " + machine.getLocation());
            System.out.println("Count: " + machine.getCount());
        } catch (RemoteException e) {
            System.out.println("Network error: " + e.getMessage());
        }
    }
}

// ν™•μ¥μ„±: μ—¬λ¬ μ§€μ  λ¨λ‹ν„°λ§ κ°€λ¥
GumballMachineRemote seoul = (GumballMachineRemote) Naming.lookup("rmi://seoul.company.com/...");
GumballMachineRemote busan = (GumballMachineRemote) Naming.lookup("rmi://busan.company.com/...");
```

---

## π§  ν•µμ‹¬ κ°λ… μ •λ¦¬

### λ¦¬ν”λ ‰μ…κ³Ό μ§λ ¬ν™”

- **λ¦¬ν”λ ‰μ…**: λ°νƒ€μ„μ— ν΄λμ¤ κµ¬μ΅°λ¥Ό λ™μ μΌλ΅ λ¶„μ„
- **Java μ§λ ¬ν™”**: `implements Serializable`λ§ ν•λ©΄ λ¦¬ν”λ ‰μ…μΌλ΅ μλ™ μ²λ¦¬

```java
// λ¦¬ν”λ ‰μ…μΌλ΅ ν•„λ“ μλ™ μ§λ ¬ν™”
Field[] fields = obj.getClass().getDeclaredFields();
for (Field field : fields) {
    if (!Modifier.isTransient(field.getModifiers())) {
        field.setAccessible(true);
        Object value = field.get(obj);
        // μλ™μΌλ΅ μ§λ ¬ν™” μ²λ¦¬
    }
}
```

### λ μ§€μ¤νΈλ¦¬ λ™μ‘

- **λ μ§€μ¤νΈλ¦¬**: μ„λΉ„μ¤ μ΄λ¦„κ³Ό λ„¤νΈμ›ν¬ μ •λ³΄λ¥Ό λ§¤ν•‘ν•λ” μ „ν™”λ²νΈλ¶€
- **μμ„ μ¤‘μ”**: λ μ§€μ¤νΈλ¦¬ μ‹μ‘ β†’ μ„λΉ„μ¤ λ“±λ΅ β†’ ν΄λΌμ΄μ–ΈνΈ μ΅°ν

```java
// λ μ§€μ¤νΈλ¦¬λ” λ©”λ¨λ¦¬ μ£Όμ†κ°€ μ•„λ‹ λ„¤νΈμ›ν¬ μ •λ³΄ μ €μ¥
{
    serviceName: "CalculatorService",
    serverHost: "192.168.1.100",
    serverPort: 1099,
    objectID: "UniqueID_12345"
}
```

### μΊμ¤ν…μ΄ ν•„μ”ν• μ΄μ 

```java
// lookup()μ€ Remote νƒ€μ… λ°ν™ (Object μ•„λ‹!)
Remote remote = Naming.lookup("...");         // μƒμ„ νƒ€μ…
CalculatorService calc = (CalculatorService) remote; // λ‹¤μ΄μΊμ¤ν…μΌλ΅ μ‹¤μ  λ©”μ„λ“ μ ‘κ·Ό
```

---

## π’΅ κΈ°μ–µν•΄μ•Ό ν•  ν•µμ‹¬ ν¬μΈνΈ

1. **ν”„λ΅μ‹ = μ¤ν…**: RMIμ—μ„ ν΄λΌμ΄μ–ΈνΈκ°€ λ°›λ” ν”„λ΅μ‹ κ°μ²΄κ°€ λ°”λ΅ μ¤ν…
2. **λ„¤νΈμ›ν¬ λ•λ¬Έμ— μ§λ ¬ν™”**: μ„λ΅ λ‹¤λ¥Έ JVM λ©”λ¨λ¦¬μ— μ ‘κ·Ό λ¶κ°€ β†’ λ°”μ΄νΈ μ¤νΈλ¦Ό λ³€ν™ ν•„μ
3. **ν¬λ…μ„±**: ν΄λΌμ΄μ–ΈνΈλ” λ΅μ»¬/μ›κ²© κµ¬λ¶„ μ—†μ΄ λ™μΌν• λ°©μ‹μΌλ΅ μ‚¬μ©
4. **λ μ§€μ¤νΈλ¦¬ μ°μ„ **: μ„λΉ„μ¤ λ“±λ΅ μ „μ— λ°λ“μ‹ λ μ§€μ¤νΈλ¦¬κ°€ μ‹¤ν–‰λμ–΄μ•Ό ν•¨
5. **μΈν„°νμ΄μ¤ μ„¤κ³„**: ν™•μ¥μ„±κ³Ό μ„μΉ ν¬λ…μ„±μ„ μ„ν•΄ κµ¬μƒ ν΄λμ¤ λ€μ‹  μ›κ²© μΈν„°νμ΄μ¤ μ‚¬μ©

```java
// λ¨λ“  κ²ƒμ„ ν•λ‚λ΅ μ—°κ²°ν•λ” λ§λ²•
ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” λ‹¨μ β†’ calc.add(10, 20)
μ‹¤μ λ΅λ” λ³µμ΅ν• κ³Όμ • β†’ μ§λ ¬ν™” + λ„¤νΈμ›ν¬ + μ—­μ§λ ¬ν™” + μ›κ²© μ‹¤ν–‰
ν•μ§€λ§ κ°λ°μλ” λ°λΌλ„ λ¨ β†’ ν”„λ΅μ‹ ν¨ν„΄μ ν! π―
```
